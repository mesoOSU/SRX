I did not get a chance to test this file in its entirety. There could be errors with the smoothing, so there is the non-smoothing version avaiable also.
